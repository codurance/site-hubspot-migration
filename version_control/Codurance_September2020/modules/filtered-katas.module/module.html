{{ require_css(get_asset_url("../../css/modules/filtered-clients.css")) }}
{% import '../../partials/clients-page-cards.html' as cards %}

{% set blogPosts = contents %}

{% set difficulties = ["Novice", "Beginner", "Competent", "Expert"] %}
{% set topics = blog_tags("katalyst", 100) %}
{% for topic in topics %}
  {% if difficulties.contains(topic.name) %}
    {% do topics.remove(topic) %}
  {% endif %}
{% endfor %}

{% set filter = { title: "Filter",
difficulties: "Difficulty",
topics: "Topics"
}
%}
{% set infoMessage = { header: "We’re sorry, your search returned no results",
paragraph: "Try adjusting your filters to find what you’re looking for."
}
%}


<main class="clients-page__main">
  <div class="clients__filter">
    <div class="clients__filter-toggle">
      <button data-filter-toggle>
        {{filter.title}}
        <i class="clients__filter-toggle-icon las la-plus" data-filter-toggle-icon>
        </i>
      </button>
    </div>
    <div class="clients__filter-dropdown-wrapper hidden" data-filters-wrapper>
      <div class="clients__filter-dropdown-container">
        <button class="clients__filter-dropdown-button" data-dropdown-button="difficulties">
          <i class="clients__filter-icon las la-tachometer-alt"></i>
          {{filter.difficulties}}
          <i class="clients__filter-dropdown-icon las la-angle-down" data-dropdown-icon="difficulties">
          </i>
        </button>
        <div class="clients__filter-dropdown-options hidden" data-dropdown-container="difficulties">
          {% for difficulty in difficulties %}
          <button class="clients__filter-dropdown-option" data-difficulty-option="{{difficulty}}">
            {{difficulty}}
            <i class="clients__filter-dropdown-option-selected-icon las la-check hidden"
               data-difficulty-option-selected="{{difficulty}}"></i>
          </button>
          {% endfor %}
        </div>
      </div>
      <div class="clients__filter-dropdown-container">
        <button class="clients__filter-dropdown-button" data-dropdown-button="topics">
          <i class="clients__filter-icon las la-tag"></i>
          {{filter.topics}}
          <i class="clients__filter-dropdown-icon las la-angle-down" data-dropdown-icon="topics">
          </i>
        </button>
        <div class="clients__filter-dropdown-options hidden" data-dropdown-container="topics">
          {% for topic in topics|sort(False,False) %}
          <button class="clients__filter-dropdown-option" data-topic-option="{{topic}}">
            {{topic}}
            <i class="clients__filter-dropdown-option-selected-icon las la-check hidden"
               data-topic-option-selected="{{topic}}"></i>
          </button>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>

  <div class="clients-applied-filters__container">
    {% for difficulty in difficulties %}
    <div class="clients-applied-filters__pill hidden" data-applied-difficulty-filter="{{difficulty}}">
      {{difficulty}}
      <i class="clients-applied-filters__remove-button las la-times" data-remove-difficulty-filter="{{difficulty}}"></i>
    </div>
    {% endfor %}
    {% for topic in topics %}
    <div class="clients-applied-filters__pill hidden" data-applied-topic-filter="{{topic}}">
      {{topic}}
      <i class="clients-applied-filters__remove-button las la-times" data-remove-topic-filter="{{topic}}"></i>
    </div>
    {% endfor %}
  </div>

  <div class="clients__no-clients-message-container hidden" data-no-clients-message>
    <h4>{{infoMessage.header}}</h4>
    <p>{{infoMessage.paragraph}}</p>
  </div>

  <div class="custom-blog-listing custom-bg-gray-light-v5">
    <div class="page-center container custom-py-50">
      <div class="masonry-grid row custom-mb-70">
        <div class="masonry-grid-sizer"></div>
        {% for content in blogPosts %}
          <div class="custom-blog-listing__post-wrapper masonry-grid-item"
              blog-tags="{{content.tag_list}}"
              >
            <article class="custom-blog-listing__post">
            {% if content.featured_image %}
              <a href="{{ content.absolute_url }}">
                <img class="custom-bg-white img-fluid w-100" src="{{ content.featured_image }}" alt="{{ content.name }}">
              </a>
            {% endif %}
              <div class="custom-bg-white custom-pa-30">
                <ul class="list-inline custom-color-gray-dark-v4 custom-font-weight-600 custom-font-size-12">
                  <li class="list-inline-item mr-0">By {{ content.blog_post_author.display_name }}</li>
                  <li class="list-inline-item mx-2">·</li>
                  <li class="list-inline-item">Posted {{ content.publish_date_localized }}</li>
                </ul>
                <h5 class="h5 custom-color-black custom-font-weight-600 mb-4">
                  <a class="custom-blog-listing__title-link" href="{{ content.absolute_url }}">
                    {{ content.name }}</a>
                </h5>

              {% if content.tag_list %}
                <ul class="list-inline custom-font-size-12 mb-0">
                {% for tag in content.tag_list %}
                  <li class="list-inline-item custom-mb-10">
                    <a class="tags custom-blog-listing__tag" href="{{ blog_tag_url(group.id, tag.slug) }}">{{ tag.name }}</a>
                  </li>
                {% endfor %}
                </ul>
              {% endif %}
              </div>
            </article>
          </div>
        {% endfor %}
      </div>

      {% if contents.total_page_count > 1 %}
      <nav class="blog-pagination text-center" role="navigation" aria-label="Pagination Navigation">
        <ul>
          {% set page_list = [-8,-7,-6,-5,-4,-3,-2, -1, 0, 1, 2,3,4,5,6,7,8] %}
          {% if contents.total_page_count - current_page_num == 1 %}{% set offset = -1 %}
          {% elif contents.total_page_count - current_page_num == 0 %}{% set offset = -2 %}
          {% elif current_page_num == 2 %}{% set offset = 1 %}
          {% elif current_page_num == 1 %}{% set offset = 2 %}
          {% else %}{% set offset = 0 %}{% endif %}
          {% if last_page_num %}
          <li class="previous-page-button">
            <a class="u-pagination-v1__item u-pagination-v1-4 custom-brd-gray-light-v3 custom-rounded-50 custom-pa-7-16 custom-hidden-xs-down {{ "blog-pagination__prev-link--disabled" if !last_page_num }}" href="{{ blog_page_link(last_page_num) }}">
            <i class="fa fa-angle-left custom-mr-5"></i>
            Previous
            </a>
          </li>
          {% endif %}
          <div class="pagination-wrapper">
            {% for page in page_list %}
            {% set this_page = current_page_num + page + offset %}
            {% if this_page > 0 and this_page <= contents.total_page_count %}
            <li>
              <a  aria-label="Goto Page {{this_page}}"
                  {% if this_page == current_page_num %}
                  aria-label="Current Page, {{this_page}}"
                  aria-current="true"
                  {% endif %}
                  class="u-pagination-v1__item u-pagination-v1-4 custom-rounded-50 custom-pa-7-14
                  {{ "u-pagination-v1-4--active" if this_page == current_page_num }}"
              href="{{ blog_page_link(this_page) }}">{{ this_page }}</a>
            </li>
            {% endif %}
            {% endfor %}
            {% if contents.total_page_count > 4 %}
            <li><a class="custom-pa-7-14"  rel="noopener noreferrer">...</a></li>
            <li><a aria-label="Goto Last Page"
                   class="u-pagination-v1__item u-pagination-v1-4 custom-rounded-50 custom-pa-7-14"
                   href="{{ blog_page_link(contents.total_page_count) }}">{{ contents.total_page_count }}</a></li>
            {% endif %}
          </div>
          {% if next_page_num %}
          <li class="next-page-button">
            <a class="u-pagination-v1__item custom-hidden-xs-down u-pagination-v1-4 custom-brd-gray-light-v3 custom-rounded-50 custom-pa-7-16
          {{ "blog-pagination__next-link--disabled" if !next_page_num }}"
            href="{{ blog_page_link(current_page_num + 1) }}">
            Next
            <i class="fa fa-angle-right custom-ml-5"></i>
            </a>
          </li>
          {% endif %}
        </ul>
      </nav> {# end pagination navigation #}
      {% endif %}
    </div>
  </div>
</main>

{{ require_js(get_asset_url("../js/imageLoaded.js")) }}
{{ require_js(get_asset_url("../../js/isotope.js"), "footer") }}
{{ require_js(get_asset_url("../../js/isotopePackery.js"), "footer") }}
